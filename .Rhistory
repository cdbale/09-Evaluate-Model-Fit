# Load the tidyverse and tidymodels packages
library(tidyverse)
library(tidymodels)
# choose a seed value
# what is this again?
set.seed(42)
# Set variable and parameter values.
# feel free to adjust these values
nobs <- 300
intercept <- 30
slope <- 9
# Simulate data.
sim_data_01 <- tibble(
discount = round(runif(nobs, min = 0, max = 20)),
sales = intercept + slope * discount + rnorm(nobs, mean = 0, sd = 5)
)
sim_data_01
sim_data_01 |>
ggplot(aes(x = discount, y = sales)) +
geom_jitter(size = 2, alpha = 0.5) +
geom_smooth(method = "lm")
# Simulate some more data.
sim_data_02 <- tibble(
coupon = rbinom(nobs, size = 1, prob = 0.7),
sales = intercept + slope * coupon + rnorm(nobs, mean = 0, sd = 5)
)
sim_data_02
sim_data_02 |>
ggplot(aes(x = coupon, y = sales)) +
geom_jitter(size = 2, alpha = 0.5) +
geom_smooth(method = "lm")
# Fit the first model.
fit_01 <- linear_reg() |>
set_engine("lm") |>
fit(sales ~ discount, data = sim_data_01)
# Fit the second model.
fit_02 <- linear_reg() |>
set_engine("lm") |>
fit(sales ~ coupon, data = sim_data_02)
# Evaluate model fit.
fit_01 |>
tidy()
# Evaluate model fit.
fit_02 |>
tidy()
# set random seed
set.seed(42)
# number of observations
nobs <- 500
intercept <- 10
slope_coupon <- 2
slope_ad <- 3
# Simulate some more data.
sim_data_example <- tibble(
coupon = rbinom(nobs, size = 1, prob = 0.7),
ad = rbinom(nobs, size = 1, prob = 0.5),
sales = intercept + slope_coupon * coupon + slope_ad * ad + rnorm(nobs, mean = 0, sd = 5)
)
sim_data_example
# Fit the example model.
fit_example <- linear_reg() |>
set_engine("lm") |>
fit(sales ~ ., data = sim_data_example)
fit_example |>
tidy()
slope_discount <- 3
slope_received_coupon <- 2
# Simulate data.
sim_data_campaign <- tibble(
discount = round(runif(nobs, min = 0, max = 20)),
coupon = rbinom(nobs, size = 1, prob = 0.5),
mail = rbinom(nobs, size = 1, prob = 0.25),
received_coupon = coupon * mail,
sales = intercept + slope_discount * discount + slope_received_coupon * received_coupon + rnorm(nobs, mean = 0, sd = 5)
)
sim_data_campaign
campaign_model <- linear_reg() |>
set_engine("lm") |>
fit(sales ~ discount + coupon, data = sim_data_campaign)
campaign_model |>
tidy()
slope_discount <- 3
slope_received_coupon <- 2
# Simulate data.
sim_data_campaign <- tibble(
discount = round(runif(nobs, min = 0, max = 20)),
coupon = rbinom(nobs, size = 1, prob = 0.5),
mail = rbinom(nobs, size = 1, prob = 0.25),
received_coupon = coupon * mail,
sales = intercept + slope_discount * discount + slope_received_coupon * received_coupon + rnorm(nobs, mean = 0, sd = 5)
)
sim_data_campaign
campaign_model <- linear_reg() |>
set_engine("lm") |>
fit(sales ~ discount + coupon, data = sim_data_campaign)
campaign_model |>
tidy()
set.seed(42)
slope_discount <- 3
slope_received_coupon <- 2
# Simulate data.
sim_data_campaign <- tibble(
discount = round(runif(nobs, min = 0, max = 20)),
coupon = rbinom(nobs, size = 1, prob = 0.5),
mail = rbinom(nobs, size = 1, prob = 0.25),
received_coupon = coupon * mail,
sales = intercept + slope_discount * discount + slope_received_coupon * received_coupon + rnorm(nobs, mean = 0, sd = 5)
)
sim_data_campaign
campaign_model <- linear_reg() |>
set_engine("lm") |>
fit(sales ~ discount + coupon, data = sim_data_campaign)
campaign_model |>
tidy()
# Load packages.
library(tidyverse)
library(tidymodels)
# Set the simulation seed.
set.seed(42)
# Set variable and parameter values.
nobs <- 500
intercept <- 50
slope <- 3
# Simulate data.
sim_data <- tibble(
discount = round(runif(nobs, min = 0, max = 20)),
coupon = rbinom(nobs, size = 1, prob = 0.7),
sales = intercept + slope * discount + rnorm(nobs, mean = 0, sd = 3)
)
sim_data
# Fit the correct model.
fit_01 <- linear_reg() |>
set_engine("lm") |>
fit(sales ~ discount, data = sim_data)
# Fit the model with a superfluous explanatory variable.
fit_02 <- linear_reg() |>
set_engine("lm") |>
fit(sales ~ discount + coupon, data = sim_data)
# Tidy model output, including confidence intervals.
tidy(fit_01, conf.int = TRUE)
tidy(fit_02, conf.int = TRUE)
# Look at r-squared.
glance(fit_01)
glance(fit_02)
# Column names need to match the fitted model.
new_data <- tibble(
discount = rep(c(10, 20, 30, 40), 2),
coupon = c(rep(0, 4), rep(1, 4))
)
new_data
# Predict and bind on prediction intervals.
predict(fit_02, new_data = new_data) |>
bind_cols(
predict(fit_02, new_data = new_data, type = "pred_int"),
new_data) |>
arrange(desc(.pred))
